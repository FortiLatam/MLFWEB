<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="fkemps@fortinet.com">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Demo - Bot Detection - FortiWeb Machine Learning</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Demo - Bot Detection";
    var mkdocs_page_input_path = "fwb-machinelearning-bot-basic.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> FortiWeb Machine Learning</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../fwb-machinelearning-refresh/">Info - Machine Learning</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Preparation (mandatory)</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../fwb-machinelearning-basic/">Demo - Anomaly Detection</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Demo - Bot Detection</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-demo-scope">1. Demo Scope</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-basic-configuration">2. Basic Configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-importing-ml-bot-models">3. Importing ML-Bot Models</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-enable-logging">4. Enable Logging</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-generating-blocking-bots">5. Generating &amp; Blocking Bots</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#6-observing-blocked-bots">6. Observing Blocked Bots</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#61-monitor-blocked-ip">6.1 Monitor Blocked IP</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#62-attack-logs">6.2 Attack Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#63-fortiview">6.3 FortiView</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../fwb-machinelearning-advanced/">Lab - Anomaly Detection</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../fwb-machinelearning-api/">Lab - API Protection</a>
                    </li>
                </ul>
      </div>
      <div class="navcenterfabric">
        <img src="../img/fabric-small.png">
      </div>
      <div class="navcenter">
        <img src="../img/fortinetlogonav.png">
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">FortiWeb Machine Learning</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Demo - Bot Detection</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="demo-bot-detection">Demo Bot Detection</h2>
<h3 id="1-demo-scope">1. Demo Scope</h3>
<p>This demo is to show the unique Machine Learning based bot detection feature and get yourself comfortable to show to partners and customers. <br />
It requires little setup to illustrate the easy of use.</p>
<p>To reduce ML learning time we will skip <strong>sample collecting</strong> and <strong>model building</strong> phases, and move direcly into <strong>model running</strong> state by importing a pre-learned model.</p>
<ul>
<li><strong>Download the pre-learned ML-Bot Model</strong> <a href="/static/docs/latest/config/FWB-BotDetect.dat">here</a>.</li>
</ul>
<h3 id="2-basic-configuration">2. Basic Configuration</h3>
<p>FortiWeb Machine Learning, both <strong>Bot Detection</strong> and <strong>Anomaly Detection</strong>, is a protection mechanism attached to the Server Policy. <br />
Policy Server <strong>Finance</strong> will be used during this exercise</p>
<ul>
<li>Policy &gt; Server Policy &gt; Finance &gt; Machine Learning &gt; Bot Detection</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-policyserver-preconf.png" /></p>
<p>By default Bot-Detection is not enabled and need to be configure like illustrated per instructions 1. and 2..
<strong>For this lab exercise it has been partly pre-configured</strong>.  </p>
<p><img alt="" src="../img/fwb-ws-bot-policyserverconf.png" /></p>
<p><img alt="" src="../img/fwb-ws-ml-bp2.png" /></p>
<h3 id="3-importing-ml-bot-models">3. Importing ML-Bot Models</h3>
<p>To speed-up the configuration we skip the automatic model learning and import the downloaded mathematical model.</p>
<ul>
<li>Policy &gt; Server Policy &gt; Finance &gt; Machine Learning &gt; Bot Detection &gt; Import</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-import.png" /></p>
<p>After you hvae successfully imported mathematicel model, you can configure and view the learned model together with a graphical representation.</p>
<ul>
<li>Policy &gt; Server Policy &gt; Finance &gt; Machine Learning &gt; Bot Detection &gt; View</li>
</ul>
<p><img alt="" src="../img/fwb-ws-ml-bp6.png" /></p>
<ul>
<li>Finish the configuration by changing the default action from <strong>Alert</strong> to <strong>Period Block</strong>.
This will block detects BOTs for a period during the demo.</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-confblockperiod.png" /></p>
<p>To view the graphical representation of the imported model by selecting the <strong>Model Status</strong> tab.   </p>
<ul>
<li>Hover over the line graphs to discover the traffic patterns of the imported model.</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-modelstatus.png" /></p>
<h3 id="4-enable-logging">4. Enable Logging</h3>
<p>We <strong>pre-configured</strong> the log settings, so you can observe both legitimate and malicious traffic. <br />
If you are starting from scratch you can enable it with the following steps.   </p>
<p>Log&amp;Report &gt; Log Config &gt; Other Log Settings: </p>
<ul>
<li>Retain Packet Payload: <strong>enable</strong>   </li>
<li>Machine Learning: <strong>enable</strong></li>
</ul>
<p><img alt="" src="img/fwb-ws-bot-logconfig.png" /></p>
<h3 id="5-generating-blocking-bots">5. Generating &amp; Blocking Bots</h3>
<p>Access the bWAPP web application to verify proper webservices.</p>
<ul>
<li>Open browser on <strong>Lubuntu Client</strong> and browse to http://finance.fortinet.demo/bWAPP/</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-bwapp.png" /></p>
<p>Next step is to generate bot traffic. Observe the traffic log and ML-Bot detection period blocking in action.</p>
<p>Login from your computer with your local ssh client into Lubuntu <code>ssh -p 10100 lubuntu@&lt;FORTIPOC-IP&gt;</code> (credentials: <strong>lubuntu</strong>/<strong>fortinet</strong>), or open an QTerminal via the Start &gt; System Tools &gt; QTerminal.</p>
<pre><code class="language-script">Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-26-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.
</code></pre>
<ul>
<li>Execture shell script <strong>bot-simulator</strong> to launch the bot attack. </li>
</ul>
<p><code>./bot-simulator.sh</code></p>
<p>This will launch 5 bots sending traffic from random IP-addresses towards the bWAPP application. <br />
During the period that bot traffic is generated you can periodically browse the bWAPP application to verify bwAPP application availability.</p>
<pre><code class="language-script">--------------------------------------------------------------------------
      FortiWeb Machine Learning - Bot Detection Bot simulator
--------------------------------------------------------------------------
Bot launched from: 163.197.140.244
Bot launched from: 191.254.117.72
Bot launched from: 49.174.143.26
Bot launched from: 138.57.125.248
Bot launched from: 27.4.103.138
Wait until BOTs reports to have stopped after 200 crawls
</code></pre>
<p>Observe on the FortiWeb dashboard you will clearly see the resouce impact:</p>
<ul>
<li>High CPU load</li>
<li>Bandwidth consumption</li>
<li>Concurrent Connections/Sec on the Finance application</li>
</ul>
<p><img alt="" src="../img/fwb-ws-bot-dashboardresources.png" /></p>
<p>Observe on <strong>Log&amp;Report &gt; Log Access &gt; Traffic</strong> that bot traffic reaches the bWAPP application.</p>
<p><img alt="" src="../img/fwb-ws-bot-logtraffic.png" /></p>
<p>After one minute approximately FortiWeb ML-Bot Detection will start blocking the bot traffic.</p>
<ul>
<li>Observe the change in resouce usage on the FortiWeb dashboard while the script is running. When the Bots are blocked, with period block due to failing Real Broweser Enforcement, the pressure on FortiWeb resources will decrease.</li>
</ul>
<pre><code class="language-script">--------------------------------------------------------------------------
      FortiWeb Machine Learning - Bot Detection Bot simulator
--------------------------------------------------------------------------
Bot launched from: 163.197.140.244
Bot launched from: 191.254.117.72
Bot launched from: 49.174.143.26
Bot launched from: 138.57.125.248
Bot launched from: 27.4.103.138
Wait until BOTs reports to have stopped after 200 crawls
Bot 163.197.140.244 blocked
Bot 163.197.140.244 blocked
Bot 163.197.140.244 blocked
Bot 163.197.140.244 blocked
Bot 163.197.140.244 blocked
Bot 163.197.140.244 blocked
Bot 191.254.117.72 blocked
Bot 163.197.140.244 blocked
Bot 49.174.143.26 blocked
Bot 191.254.117.72 blocked
Bot 163.197.140.244 blocked
Bot 49.174.143.26 blocked
Bot 191.254.117.72 blocked
Bot 163.197.140.244 blocked
Bot 49.174.143.26 blocked
Bot 191.254.117.72 blocked
Bot 163.197.140.244 blocked
Bot 49.174.143.26 blocked
Bot 191.254.117.72 blocked
&lt;skip&gt;
Bot 27.4.103.138 blocked
Bot 138.57.125.248 blocked
Bot 27.4.103.138 blocked
Bot 138.57.125.248 blocked
Bot 27.4.103.138 blocked
Bot 138.57.125.248 blocked
Bot 27.4.103.138 blocked
Bot 138.57.125.248 blocked
Bot 27.4.103.138 blocked
Bot 138.57.125.248 blocked
Bot stopped from : 163.197.140.244
Bot stopped from : 191.254.117.72
Bot stopped from : 49.174.143.26
Bot stopped from : 138.57.125.248
Bot stopped from : 27.4.103.138
</code></pre>
<p><img alt="" src="../img/fwb-ws-bot-dashboardblockresource.png" /></p>
<h3 id="6-observing-blocked-bots">6. Observing Blocked Bots</h3>
<p>Blocked bots are listed in the Dashboard &gt; FortiView section under <strong>Blocked IP</strong> monitoring section (add it first with + icon) and  <strong>Attack Log</strong>. <br />
Feel free to release one or two bots and observe that those are not blocked anymore.</p>
<h4 id="61-monitor-blocked-ip">6.1 Monitor Blocked IP</h4>
<p>There is an option to manually release the blocked IP.</p>
<p><img alt="" src="../img/fwb-ws-bot-blockedip.png" /></p>
<h4 id="62-attack-logs">6.2 Attack Logs</h4>
<p>FortiWeb Attack Log shows the blocked bots triggered by Machine Learning - Bot Detection performing <strong>Bot Verification</strong> with <strong>Real Browser Validation</strong>.</p>
<p><img alt="" src="../img/fwb-ws-bot-attacklog.png" /></p>
<h4 id="63-fortiview">6.3 FortiView</h4>
<p>Navigate through the FortiView menu to discover bot logging, especially the <strong>Security Threat map</strong>.</p>
<p><img alt="" src="../img/fwb-ws-bot-fvcountry.png" /></p>
<p><img alt="" src="../img/fwb-ws-bot-fvthreats.png" /></p>
<p><img alt="" src="../img/fwb-ml-bot-fvthreatsbots.png" /></p>
<p><img alt="" src="../img/fwb-ws-bot-fviewmap.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../fwb-machinelearning-advanced/" class="btn btn-neutral float-right" title="Lab - Anomaly Detection">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../fwb-machinelearning-basic/" class="btn btn-neutral" title="Demo - Anomaly Detection"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>© Fortinet</p>
    
  </div>

  Provided by CSE-team International.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../fwb-machinelearning-basic/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../fwb-machinelearning-advanced/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
